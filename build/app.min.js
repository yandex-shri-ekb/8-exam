define("app/utils/string",[],function(){String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})})}),define("app/utils/array",[],function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1})}),define("app/image_preloader",["jquery"],function(a){function b(){this._waitLoading=null}return b.prototype.preload=function(b){var c=this,d=new Image,e=a.Deferred();return null!==c._waitLoading&&(c._waitLoading.onload=function(){},c._waitLoading=null),d.src=b,d.complete?e.resolve(b):(c._waitLoading=d,d.onload=function(){e.resolve(b),d.onload=function(){}}),e.promise()},b}),define("app/utils/random",[],function(){var a={};return a.getInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a}),define("app/app",["jquery","app/image_preloader","app/utils/random"],function(a,b,c){function d(){this.config={},e(t[c.getInt(0,2)]),k()}function e(b){if(!n.hasClass("b-page_"+b)){n.removeClass(u.join(" ")),n.addClass("b-page_"+b),a(".char-text").hide(),a(".char-text_"+b).show(),a(".story__char").hide(),a("#story-"+b).show(),a(".info__char").hide(),a("#info-"+b).show();var c=a(".char");a.each(t,function(a,b){c.removeClass("char-"+b+"_selected")}),a(".char-"+b).addClass("char-"+b+"_selected");var d=a(".char-floated__image");a.each(t,function(a,b){d.removeClass("char-floated__image_"+b)}),d.addClass("char-floated__image_"+b),n.addClass("b-page_"+b),-1===w.indexOf(b)&&h(b)}}function f(){var b=null;return a.each(t,function(a,c){n.hasClass("b-page_"+c)&&(b=c)}),b}function g(b){var c,d=f(),e=y[d],g=null;a(".char-state",r).hide().removeClass("char-state_selected"),a.each(e,function(a,d){var e=Math.abs(d.center-b);(null===g||g>e)&&(g=e,c=d.state)}),a.each(t,function(b,e){var f=a(".char-state-"+e+"-"+c,r);f.show(),e===d&&f.addClass("char-state_selected")})}function h(b){a("#info-"+b).find(".info-part").each(function(){var b=a(this),c=a(b.data("related")),d=b.outerHeight(),e=b.offset().top+d,f=c.offset().top+c.outerHeight(),g=d+(f-e);b.height(g)}),y[b]=[],a("#story-"+b).find(".story__part").each(function(){var c=a(this),d=c.data("state"),e=c.offset().top+c.height()/2;y[b].push({$part:c,state:d,center:e})}),-1===w.indexOf(b)&&w.push(b)}function i(){var a=s.data("status");if(a)s.animate({left:v},"fast"),s.data("status",0);else{var b=j();s.animate({left:b},"fast"),s.data("status",1)}}function j(){var a=l.width(),b=s.offset().left,c=a-b;0>c&&(c=0);var d=a-c-z,e=A-c;d=0>d?0:d;var f=d>=e?e:d,g=b-f;return g>v?v:g}function k(){a(".switcher-top,.switcher-bottom").on("click",".char",function(){var b=a(this);switch(!0){case b.hasClass("char-yellow"):e("yellow");break;case b.hasClass("char-red"):e("red");break;case b.hasClass("char-blue"):e("blue")}if(b.closest(".switcher-bottom").length>0){var c=o.offset().top;m.add("html").animate({scrollTop:c},"slow")}return!1}),l.scroll(function(){var a=l.height(),b=l.scrollTop(),c=b+a,d=b+a/2;b>x.charFloated[0]&&c<x.charFloated[1]?(q.fadeIn("fast"),r.fadeIn("fast"),g(d)):(q.fadeOut("fast"),r.fadeOut("fast"))}),l.resize(function(){var a=s.data("status");if(a){var b=j();s.css({left:b+"px"})}}),a(".open-btn").on("click",i);var b=a(".char-text");a(".char",o).hover(function(){var c=a(this);b.hide(),a.each(t,function(a,d){return c.hasClass("char-"+d)?(b.filter(".char-text_"+d).show(),!1):void 0})},function(){var a=f();b.hide(),b.filter(".char-text_"+a).show()}),a(".char-state").on("click",function(){var b=f(),c=a(this),d=null;a.each(t,function(a,b){-1!==c.attr("id").indexOf(b)&&(d=b)}),b!==d&&(e(d),a(".char-state_selected").removeClass("char-state_selected"),c.addClass("char-state_selected"))})}var l=a(window),m=a(document.body),n=a(".b-page",m),o=a(".switcher-top"),p=a(".switcher-bottom"),q=a(".char-floated"),r=a(".switcher-floated"),s=a(".layout__floated"),t=["yellow","red","blue"],u=["b-page_yellow","b-page_red","b-page_blue"],v=s.offset().left,w=[],x={charFloated:[0,0]},y={yellow:[],red:[],blue:[]},z=200,A=870;return d.prototype.init=function(){x.charFloated=[o.offset().top+o.height(),p.offset().top],w=[],h(f())},d}),define("app/modal",["jquery"],function(a){function b(b){this.$modal=b,d||(d=!0,c=a('<div class="modal__backdrop"></div>').appendTo(a("body"))),b.click(function(){a.each(e,function(a,b){b.hide()})}),a(".modal__dialog",b).click(function(){return!1})}var c=null,d=!1,e=[];return b.prototype.show=function(){this.$modal.show(),c.show(),e.push(this)},b.prototype.hide=function(){this.$modal.hide();var a=e.indexOf(this);-1!==a&&e.splice(a,1),0===e.length&&c.hide()},b}),define("app/init",["app/app","jquery","app/modal"],function(a,b,c){function d(){var a=new c(b("#modal"));b(".video-btn__btn").click(function(){a.show()})}var e=new a;b(function(){e.init(),d()})}),require.config({paths:{jquery:"//yandex.st/jquery/1.10.2/jquery.min"},shim:{}}),require(["app/utils/string"]),require(["app/utils/array"]),require(["app/init"]),define("main",function(){});
//# sourceMappingURL=build/app.min.map