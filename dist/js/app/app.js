define(["app/random","jquery"],function(e,t){function S(e,t){e.hover(function(){t.find(".person__desc").hide()},function(){t.find(".person__desc").css("display","")})}function x(e){t("html,body").animate({scrollTop:e.offset().top},800)}function T(e,n){var r=t(window).scrollTop(),i=t(e).offset().top,s=r+t(window).height(),o=i+t(e).height()+Number(t(e).css("padding-top").replace("px",""));return o>=r&&i<=r&&s<=n}function N(e){var n="",r="";if(e=="yellow"){n="red";r="blue"}else if(e=="red"){n="yellow";r="blue"}else{n="yellow";r="red"}for(var i=2;i<6;i++){if(T(t("."+e+"_block"+i),foot)){b.attr("class","icons_yellow");w.attr("class","icons_red");E.attr("class","icons_blue");t(".icons_"+e).addClass("icon_"+e+"_block"+i+"_active");t(".icons_"+n).addClass("icon_"+n+"_block"+i);t(".icons_"+r).addClass("icon_"+r+"_block"+i)}else{t(".icons_"+e).removeClass("icon_"+e+"_block"+i+"_active");t(".icons_"+n).removeClass("icon_"+n+"_block"+i);t(".icons_"+r).removeClass("icon_"+r+"_block"+i)}}}var n=t(".person__yellow"),r=t(".person__red"),i=t(".person__blue"),s=t(".person__yellow.foot"),o=t(".person__red.foot"),u=t(".person__blue.foot"),a=t(".person__desc"),f=t(".yellow"),l=t(".red"),c=t(".blue"),h=t(".content"),p=t(".play"),d=t(".history"),v=t(".persons"),m=t(".persons__footer"),g=t(".this_story"),y=t(".icons_story"),b=t(".icons_yellow"),w=t(".icons_red"),E=t(".icons_blue");App=function(){this.color="";n.click(t.proxy(this.yellow,this));r.click(t.proxy(this.red,this));i.click(t.proxy(this.blue,this));s.click(t.proxy(this.yellowF,this));o.click(t.proxy(this.redF,this));u.click(t.proxy(this.blueF,this));b.click(t.proxy(this.iconChar,this));w.click(t.proxy(this.iconChar,this));E.click(t.proxy(this.iconChar,this))};App.prototype.init=function(){var t=this;switch(e){case 1:t.yellow();break;case 2:t.red();break;case 3:t.blue();break;default:t.yellow();break}t.renderStory()};App.prototype.yellow=function(e){var t=this;t.clearChar();t.color="yellow";S(r,n);S(i,n);t.chengeChar(n)};App.prototype.red=function(e){var t=this;t.clearChar();t.color="red";S(n,r);S(i,r);t.chengeChar(r)};App.prototype.blue=function(e){var t=this;t.clearChar();t.color="blue";S(n,i);S(r,i);t.chengeChar(i)};App.prototype.chengeChar=function(e){var t=this;e.find(".person__"+t.color+"__avatar").addClass("active");e.find(".person__desc").addClass("view");t.renderStory()};App.prototype.yellowF=function(e){var n=this;n.yellow();x(t(".persons"))};App.prototype.redF=function(e){var n=this;n.red();x(t(".persons"))};App.prototype.blueF=function(e){var n=this;n.blue();x(t(".persons"))};App.prototype.clearChar=function(){var e=this;t(".person__"+e.color+"__avatar").removeClass("active");a.removeClass("view");f.hide();l.hide();c.hide();h.removeClass(e.color+"__color");p.removeClass(e.color+"__color");d.removeClass("history__"+e.color);g.removeClass(e.color+"_character")};App.prototype.renderStory=function(){var e=this;t("."+e.color).show();h.addClass(e.color+"__color");p.addClass(e.color+"__color");d.addClass("history__"+e.color);g.addClass(e.color+"_character");foot=d.offset().top+d.height();window.onscroll=function(){N(e.color);if(T(t("."+e.color),foot)){g.show();y.show()}else{g.hide();y.hide()}}};App.prototype.iconChar=function(e){var n=this,r=e.target;for(var i=2;i<6;i++){if(t(r).hasClass("icon_yellow_block"+i)){n.yellow();x(t(".yellow_block"+i))}else if(t(r).hasClass("icon_red_block"+i)){n.red();x(t(".red_block"+i))}else if(t(r).hasClass("icon_blue_block"+i)){n.blue();x(t(".blue_block"+i))}}};return App})